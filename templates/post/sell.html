{% extends 'base/main.html' %}
{% load static %}
{% block content %}
<section class="features18 popup-btn-cards cid-qzvQdijbXZ" id="features18-1o" data-rv-view="101">
  <div class="container">
  <!-- {% for post in posts %}
      {% if forloop.counter == 1 or forloop.counter0|divisibleby:4 %}
        <div class="media-container-row pt-5 ">
          {% endif %}
            <div class="card p-3 col-12 col-md-6 col-lg-3">
                <div class="card-wrapper ">
                    <div class="card-img">
                        <div class="mbr-overlay"></div>
                        <div class="mbr-section-btn text-center">
                            <a href="https://mobirise.com" class="btn btn-primary display-4">
                                {{ forloop.counter0 }}
                            </a>
                        </div>
                        <img src="{{ post.image_1.url }}" alt="Mobirise" media-simple="true">
                    </div>
                    <div class="card-box">
                        <h4 class="card-title mbr-fonts-style display-7">
                            {{ post.title }}
                        </h4>
                    </div>
                </div>
            </div>
            {% if forloop.counter|divisibleby:4 %}
        </div>
             {% endif %}
      {% endfor %} -->
  </div>
</section>
<script type="text/javascript">
var offset = 4;
var count = "{{ count }}"
var isLoading = false;
$(window).scroll(function() {
 if($(window).scrollTop() + $(window).height() > $(document).height() - 100) {
   if(isLoading == false){
     loadPostList();
     offset += 4
   }
 }
});
function loadPostList() {
  isLoading = true;
  var newDom = new Array();
  var newDomCard = new Array();
  $.ajax({
    url: '/post/ajax/sell/?offset=' + offset,
    success: function(data){
      for (var i = 0; i < data.length; i++){
        var firstPost = data[0];
        var CurPost = data[i];
        if (i == 0){
          newDom[firstPost.pk] = $('<div class="media-container-row pt-5 "></div>');
        $('.cid-qzvQdijbXZ .container').append(newDom[firstPost.pk]);
      }
        newDom[firstPost.pk].append('<div class="card p-3 col-12 col-md-6 col-lg-3"><div class="card-wrapper card'+i+' popup-btn"></div></div>');
        var newDomCard = newDom[firstPost.pk].find('div.card'+i+'');
        newDomCard.append('<div class="card-img"></div>');
        var newDomCardimg = newDomCard.find('.card-img');
        newDomCardimg.append('<div class="mbr-overlay"></div>')
        newDomCardimg.append('<div class="mbr-section-btn text-center"></div>')
        newDomCardimg.append('<img src="'+CurPost.photo+'" alt="Mobirise" media-simple="true">')
        var newDomCard_a_tag = newDomCardimg.find('div.mbr-section-btn')
        newDomCard_a_tag.append('<a href="https://mobirise.com" class="btn btn-primary display-4">자세히 보기</a>')

      }
}
});
  setTimeout(function()
    {
      isLoading = false;
    },2000);
}
</script>
{% endblock %}
